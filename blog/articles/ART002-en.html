<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Complete Guide to scRNA-seq Analysis - Huseyn Babayev</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide-static@latest/umd/lucide.js"></script>
    <link rel="stylesheet" href="/css/main.css">
</head>
<body data-article-code="ART002" data-current-lang="en">
    <div id="main-header"></div>

    <main class="article-full">
        <aside class="article-toc">
            <div class="toc-header">
                <a href="/blog.html" class="back-to-blog-btn" data-lang-key="back_to_blog">&larr; Back to Blog</a>
            </div>
            <!-- Table of Contents will be generated by JavaScript -->
        </aside>
        
        <div class="article-content">
            <header class="article-header">
                <h1 data-lang-key="scrna_title">A Complete Guide to scRNA-seq Analysis</h1>
                <p class="article-meta">Published on <time datetime="2024-07-26">July 26, 2024</time> by Huseyn Babayev</p>
            </header>
            <article>
                <h2 data-lang-key="scrna_intro_title">Introduction</h2>
                <p data-lang-key="scrna_intro_p1">Single-cell RNA sequencing (scRNA-seq) has revolutionized our ability to study complex biological systems by enabling high-throughput transcriptomic profiling at the single-cell level. For bioinformatics researchers, the R/Bioconductor ecosystem provides a comprehensive and powerful suite of tools for analyzing scRNA-seq data, from basic quality control to advanced multi-modal integration. This guide covers the key packages and best practices for conducting a complete scRNA-seq analysis workflow in R.</p>

                <h2 data-lang-key="scrna_core_packages_title">Core Packages for scRNA-seq Data Handling</h2>
                <p data-lang-key="scrna_core_packages_p1">The foundation of any scRNA-seq analysis in Bioconductor is built upon a set of core packages that provide standardized data structures and fundamental functionalities.</p>
                <ul>
                    <li><strong>SingleCellExperiment:</strong> This package defines the <code>SingleCellExperiment</code> (SCE) class, the cornerstone data structure for storing scRNA-seq data. It extends the <code>SummarizedExperiment</code> class to include specialized slots for dimensionality reduction results (e.g., PCA, UMAP, t-SNE), size factors for normalization, and other single-cell-specific metadata.</li>
                    <li><strong>scater:</strong> Provides essential tools for quality control (QC), visualization, and preprocessing of scRNA-seq data. It includes functions for calculating QC metrics, identifying low-quality cells, and performing basic normalization.</li>
                    <li><strong>scran:</strong> Offers more advanced methods for normalization, batch correction, feature selection, and cell cycle phase assignment.</li>
                </ul>

                <h2 data-lang-key="scrna_qc_title">Step 1: Quality Control and Filtering</h2>
                <p data-lang-key="scrna_qc_p1">The first critical step in any scRNA-seq analysis is rigorous quality control to remove low-quality cells and problematic features. The goal is to filter out technical artifacts while retaining genuine biological variation.</p>
                <h3 data-lang-key="scrna_qc_metrics_title">Key QC Metrics</h3>
                <ul>
                    <li><strong>Library Size:</strong> The total number of unique molecular identifiers (UMIs) per cell. Cells with very low library sizes may be damaged or empty droplets.</li>
                    <li><strong>Number of Expressed Features:</strong> The number of genes detected per cell. Low numbers can indicate poor capture efficiency.</li>
                    <li><strong>Mitochondrial Gene Content:</strong> A high percentage of mitochondrial reads often indicates cell stress or apoptosis.</li>
                </ul>
                <h3 data-lang-key="scrna_qc_methods_title">Adaptive Thresholding with scater</h3>
                <p data-lang-key="scrna_qc_methods_p1">Instead of using arbitrary hard thresholds, <code>scater</code> recommends using adaptive thresholding based on robust statistical measures. The <code>isOutlier</code> function can identify outlier cells based on thresholds set at multiple median absolute deviations (MADs) from the median, providing a more data-driven approach to filtering.</p>

                <h2 data-lang-key="scrna_normalization_title">Step 2: Normalization</h2>
                <p data-lang-key="scrna_normalization_p1">Normalization is essential to remove cell-specific biases (e.g., library size, capture efficiency) so that gene expression levels are comparable across cells. The most widely used method is deconvolution-based normalization implemented in the <code>scran</code> package.</p>
                <h3 data-lang-key="scrna_deconvolution_title">Deconvolution Size Factors</h3>
                <p data-lang-key="scrna_deconvolution_p1">The <code>computeSumFactors</code> function in <code>scran</code> pools cells with similar library sizes to compute robust size factors that account for technical variability and compositional differences between cell types.</p>

                <h2 data-lang-key="scrna_feature_selection_title">Step 3: Feature Selection</h2>
                <p data-lang-key="scrna_feature_selection_p1">To focus on biologically relevant genes and reduce computational noise, it's important to select highly variable genes (HVGs). The <code>scran</code> package provides the <code>modelGeneVar</code> function to model the relationship between the mean and variance of gene expression, identifying genes that are more variable than expected by chance.</p>

                <h2 data-lang-key="scrna_dim_reduction_title">Step 4: Dimensionality Reduction</h2>
                <p data-lang-key="scrna_dim_reduction_p1">Dimensionality reduction is used to visualize high-dimensional scRNA-seq data in a low-dimensional space (typically 2D or 3D). The two main methods are:</p>
                <ul>
                    <li><strong>Principal Component Analysis (PCA):</strong> A linear method used to capture the main axes of variation in the data.</li>
                    <li><strong>Uniform Manifold Approximation and Projection (UMAP):</strong> A non-linear method that excels at preserving the global structure and local neighborhood information of the data, making it ideal for visualization.</li>
                </ul>

                <h2 data-lang-key="scrna_clustering_title">Step 5: Clustering and Cell Type Annotation</h2>
                <p data-lang-key="scrna_clustering_p1">Clustering aims to group cells into distinct populations based on their transcriptomic similarity. A common approach is graph-based clustering, which involves building a shared nearest-neighbor (SNN) graph and then using community detection algorithms like Walktrap or Louvain to identify clusters.</p>
                <h3 data-lang-key="scrna_annotation_title">Marker Gene Identification</h3>
                <p data-lang-key="scrna_annotation_p1">Once clusters are identified, the next step is to annotate them with known cell types. The <code>findMarkers</code> function in <code>scran</code> can identify upregulated genes in each cluster compared to all other cells. These marker genes can then be compared against known cell type-specific gene sets from databases like CellMarker or PanglaoDB to assign biological labels.</p>

                <h2 data-lang-key="scrna_advanced_topics_title">Advanced Topics</h2>
                <ul>
                    <li><strong>Trajectory Inference:</strong> Packages like <code>slingshot</code> can model developmental trajectories and infer pseudotime to study dynamic processes like cell differentiation.</li>
                    <li><strong>Multi-modal Integration:</strong> Tools like <code>Seurat</code> (which can be integrated with Bioconductor objects) and the upcoming <code>Azimuth</code> reference mapping allow for the integration of scRNA-seq data with other modalities like scATAC-seq.</li>
                    <li><strong>Batch Correction:</strong> For datasets from multiple experiments or batches, methods like Mutual Nearest Neighbors (MNN) in the <code>batchelor</code> package are crucial for removing technical batch effects.</li>
                </ul>

                <h2 data-lang-key="scrna_conclusion_title">Conclusion</h2>
                <p data-lang-key="scrna_conclusion_p1">The R/Bioconductor ecosystem provides a robust, flexible, and comprehensive environment for scRNA-seq analysis. By leveraging core packages like <code>SingleCellExperiment</code>, <code>scater</code>, and <code>scran</code>, researchers can build reproducible and scalable analysis pipelines that unlock deep biological insights from single-cell data.</p>
            </article>
        </div>
    </main>

    <!-- Footer -->
    <div id="main-footer"></div>

    <!-- Scripts -->
    <script src="/js/main.js"></script>
    <script src="/js/lang/translations.js"></script>
    <script src="/js/lang/lang-switcher.js"></script>
    <script src="/js/theme-switcher.js"></script>
    <script src="/admin/articles-db.js"></script>
    <script src="/js/lang/language-controller.js"></script>
    <script src="/js/lang-redirector.js"></script>
    <script src="/js/toc.js"></script>
</body>
